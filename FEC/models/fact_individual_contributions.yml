version: 2
sources:
  - name: staged # This should match the schema name where your source tables are located.
    database: CAMPAIGN_FINANCE
    schema: staged # Adjust this to the actual schema name in your database if different.
    tables:
      - name: sta_indiv
        description: "The source table for individual contributions."

models:
  - name: fact_individual_contributions
    description: "A fact table that stores individual contributions to candidates and committees, sourced from the STA_INDIV table."
    config:
      materialized: table
      schema: FEC
    columns:
      - name: contribution_key
        description: "A surrogate key for each contribution, generated by the row_number() window function."
        tests:
          - unique
          - not_null
      - name: committee_key
        description: "A foreign key to the committee dimension table."
        tests:
          - foreign_key:
              to: source('DBT_AYUSHSASEENDRAN_FEC', 'dim_committee')
              field: "committee_key"
          - not_null
      - name: candidate_key
        description: "A foreign key to the candidate dimension table."
        tests:
          - foreign_key:
              to: source('DBT_AYUSHSASEENDRAN_FEC', 'dim_candidate')
              field: "candidate_key"
          - not_null
      - name: contributor_key
        description: "A foreign key to the contributor dimension table."
        tests:
          - foreign_key:
              to: source('DBT_AYUSHSASEENDRAN_FEC', 'dim_contributors')
              field: "contributor_key"
          - not_null
      - name: report_type_key
        description: "A foreign key to the report type reference table."
        tests:
          - not_null
      - name: transaction_type_key
        description: "A foreign key to the transaction type dimension table."
        tests:
          - not_null
      - name: contribution_amount_usd
        description: "The amount of the contribution in USD."
        tests:
          - not_null
      - name: transaction_id
        description: "The unique identifier for the transaction."
        tests:
          - not_null
